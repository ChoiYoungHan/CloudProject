<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>ì‚¬íšŒ ë‰´ìŠ¤</title>
  <link rel="stylesheet" href="/category/society/static/style.css">
</head>
<body>

<!-- ìƒë‹¨ ë°” -->
<div class="top-bar">
  <div class="top-inner">
    <div class="logo">
      <img src="/category/society/static/logo.png" alt="ë¡œê³ ">
    </div>
  </div>
</div>  

<!-- íƒ­ë°” ê³ ì • -->
<div class="category-tabs">
  <button onclick="location.href='/all'">ì „ì²´</button>
  <button onclick="location.href='/category/politics'">ì •ì¹˜</button>
  <button onclick="location.href='/category/society'">ì‚¬íšŒ</button>
  <button onclick="location.href='/category/entertainment'">ì—°ì˜ˆ</button>
</div>

<!-- ì½˜í…ì¸  ë¡œë”© ì˜ì—­ -->
<div class="news-box">
  <h3>ğŸ”¥ ì§€ê¸ˆ í™”ì œì¸ ì‚¬íšŒ ë‰´ìŠ¤</h3>
  <div id="hot-news"></div>
</div>

<div class="news-box">
  <h3>ìµœì‹  ë‰´ìŠ¤</h3>
  <div id="latest-news"></div>
</div>

<!-- ë¡œë”© ìƒíƒœ ë° ì˜¤ë¥˜ ì¶œë ¥ -->
<div id="loader" class="no-news">ë¡œë”© ì¤‘...</div>

<script>
async function fetchNews() {
  const loader = document.getElementById("loader");
  loader.style.display = "block";
  loader.innerText = "ë¡œë”© ì¤‘...";

  try {
    const res = await fetch("/api/category/society");
    if (!res.ok) throw new Error("ì˜¤ë¥˜ ì‘ë‹µ");
    const data = await res.json();
    loader.style.display = "none";
    renderHotNews(data.hot_news);
    renderLatestNews(data.latest_news);
  } catch (err) {
    loader.innerText = "âš ï¸ ì„œë²„ ì˜¤ë¥˜. 5ì´ˆ í›„ ì¬ì‹œë„í•©ë‹ˆë‹¤.";
    setTimeout(fetchNews, 5000);
  }
}

function renderHotNews(newsList) {
  const area = document.getElementById("hot-news");
  if (newsList.length === 0) {
    area.innerHTML = '<div class="no-news">ë‰´ìŠ¤ê°€ ì—†ìŠµë‹ˆë‹¤.</div>';
    return;
  }
  area.innerHTML = newsList.map(article => `
    <a href="/category/society/${article.timestamp}/${encodeURIComponent(article.title)}">
      <div class="main-news">
        <img src="${article.image}" class="thumbnail" alt="ì´ë¯¸ì§€">
        <div class="main-content">
          <div class="title">${article.title}</div>
          <div class="content">${article.content}</div>
        </div>
      </div>
    </a>
  `).join("");
}

function renderLatestNews(newsList) {
  const area = document.getElementById("latest-news");
  area.innerHTML = newsList.map(article => `
    <a href="/category/society/${article.timestamp}/${encodeURIComponent(article.title)}">
      <div class="main-news">
        <img src="${article.image}" class="thumbnail" alt="ì´ë¯¸ì§€">
        <div class="main-content">
          <div class="title">${article.title}</div>
          <div class="content">${article.content}</div>
        </div>
      </div>
    </a>
  `).join("");
}

fetchNews();
</script>

</body>
</html>
